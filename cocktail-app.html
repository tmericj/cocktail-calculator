<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P03QLJK0W7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-P03QLJK0W7');
    </script>
    <title>Calcolatore Gradazione Alcolica</title>
    <style>
        /* CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        input, textarea {
            -webkit-user-select: text;
            -khtml-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { 
                transform: translateX(-20px) translateY(-20px); 
                opacity: 0; 
            }
            50% { 
                transform: translateX(20px) translateY(20px); 
                opacity: 1; 
            }
        }

        .header h1, .header p {
            position: relative;
            z-index: 1;
        }

        .content {
            padding: 30px 20px;
        }

        .section {
            margin-bottom: 30px;
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }

        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            -webkit-appearance: none;
            appearance: none;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            -webkit-appearance: none;
            appearance: none;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
        }

        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.4);
            color: white;
        }

        .results {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 1px solid rgba(79, 172, 254, 0.1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e1e8ed;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: 600;
            color: #555;
        }

        .result-value {
            font-weight: 700;
            color: #333;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            font-size: 14px;
            color: #856404;
        }

        .cocktail-list {
            max-height: 300px;
            overflow-y: auto;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 1px solid rgba(79, 172, 254, 0.1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            -webkit-overflow-scrolling: touch;
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .results:hover, .cocktail-list:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .cocktail-item {
            padding: 15px;
            border-bottom: 1px solid #e1e8ed;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .cocktail-item:active {
            background: #e9ecef;
        }

        .cocktail-item:last-child {
            border-bottom: none;
        }

        .cocktail-name {
            font-weight: 600;
            color: #333;
        }

        .cocktail-info {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .search-box {
            margin-bottom: 20px;
        }

        /* Stili per i filtri di ricerca */
        .search-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: nowrap; /* Impedisce ai filtri di andare a capo */
            -webkit-overflow-scrolling: touch; /* Scorrimento fluido su iOS */
            /* overflow-x: auto; /* Abilita lo scorrimento orizzontale */
        }

        .filter-chip {
            flex: 1; /* Ogni chip occupa spazio uguale */
            padding: 12px 8px; /* Aumentato da 8px a 12px per mobile */
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 12px; /* Allineato con il border-radius degli input */
            font-size: 14px; /* Aumentato da 12px per leggibilità mobile */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            text-align: center; /* Centra il testo */
            min-height: 44px; /* Altezza minima per touch targets */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .filter-chip.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: scale(1.02); /* Leggero effetto di "pressione" */
        }

        /* Hover solo su dispositivi che supportano il hover (desktop) */
        @media (hover: hover) and (pointer: fine) {
            .filter-chip:active {
                transform: scale(0.95);
                transition: transform 0.1s ease;
            }

            .filter-chip:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                transition: all 0.2s ease;
            }

            .filter-chip.active:hover {
                transform: translateY(-1px) scale(1.02);
            }

            .tab:hover, .btn:hover {
                opacity: 0.9;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }
        }

        /* Effetti touch specifici per mobile */
        @media (hover: none) and (pointer: coarse) {
            .filter-chip {
                /* Feedback visivo migliore per touch */
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }

            .filter-chip:active {
                transform: scale(0.95);
                box-shadow: 0 2px 8px rgba(79, 172, 254, 0.3);
                transition: all 0.1s ease;
            }

            /* Touch feedback per bottoni */
            .btn:active {
                transform: scale(0.96) translateY(1px);
                box-shadow: 0 4px 15px rgba(79, 172, 254, 0.5);
                transition: all 0.15s ease;
            }

            .btn-secondary:active {
                box-shadow: 0 4px 15px rgba(168, 237, 234, 0.5);
            }

            /* Touch feedback per tabs */
            .tab:active {
                transform: scale(0.95);
                background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
                transition: all 0.1s ease;
            }

            .tab.active:active {
                transform: scale(0.97);
                box-shadow: 0 4px 15px rgba(116, 185, 255, 0.4);
            }

            /* Touch feedback per cocktail items */
            .cocktail-item {
                transition: all 0.2s ease;
                border-radius: 8px;
                margin-bottom: 3px;
            }

            .cocktail-item:active {
                background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                color: white;
                transform: scale(0.98);
                box-shadow: 0 3px 15px rgba(79, 172, 254, 0.4);
            }

            .cocktail-item:active .cocktail-name {
                color: white;
            }

            .cocktail-item:active .cocktail-info {
                color: rgba(255, 255, 255, 0.9);
            }

            /* Touch feedback per input fields */
            input:focus, select:focus {
                transform: scale(1.02);
                transition: all 0.2s ease;
            }

            /* Touch feedback per results e cocktail-list */
            .results, .cocktail-list {
                touch-action: pan-y;
            }

            /* Miglioramento scrolling per cocktail-list */
            .cocktail-list {
                -webkit-overflow-scrolling: touch;
                scroll-behavior: smooth;
            }

            /* Touch feedback per added-drink buttons */
            .added-drink button:active {
                transform: scale(0.9);
                box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
                transition: all 0.1s ease;
            }

            /* Vibration effect per legal status (se supportato) */
            .legal-danger, .legal-warning {
                animation: mobileAlert 0.5s ease-in-out;
            }

            @keyframes mobileAlert {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
                20%, 40%, 60%, 80% { transform: translateX(2px); }
            }

            /* Feedback tattile per form validation errors */
            input:invalid:focus {
                animation: shakeInput 0.3s ease-in-out;
                border-color: #fd79a8;
                box-shadow: 0 0 0 3px rgba(253, 121, 168, 0.2);
            }

            @keyframes shakeInput {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }

            /* Smooth section transitions ottimizzate per touch */
            .section.active {
                animation: mobileSectionEnter 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            }

            @keyframes mobileSectionEnter {
                0% {
                    opacity: 0;
                    transform: translateY(20px) scale(0.97);
                }
                60% {
                    opacity: 0.8;
                    transform: translateY(-5px) scale(1.01);
                }
                100% {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }

            /* Touch target improvements */
            .tab {
                min-height: 48px; /* Linee guida Material Design per touch targets */
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .filter-chip {
                min-height: 48px;
            }

            /* Focus states per navigazione con switch control */
            .btn:focus,
            .tab:focus,
            .cocktail-item:focus,
            .filter-chip:focus {
                outline: 3px solid #4facfe;
                outline-offset: 2px;
            }

            /* Stati di caricamento per feedback immediato */
            .btn.loading {
                position: relative;
                color: transparent;
            }

            .btn.loading::after {
                content: '';
                position: absolute;
                width: 16px;
                height: 16px;
                top: 50%;
                left: 50%;
                margin-left: -8px;
                margin-top: -8px;
                border-radius: 50%;
                border: 2px solid #ffffff;
                border-color: #ffffff transparent #ffffff transparent;
                animation: spin 1.2s linear infinite;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            /* Miglioramento per landscape mode mobile */
            @media (orientation: landscape) {
                .header {
                    padding: 15px 20px;
                }
        
                .content {
                    padding: 15px 20px;
                }
        
                .cocktail-list {
                    max-height: 180px;
                }
        
                .section {
                    min-height: 250px;
                }
            }
        }

        .search-stats {
            font-size: 12px;
            color: #666;
            margin-bottom: 15px;
            text-align: center;
            min-height: 18px; /* Previene il "salto" della UI quando appare/scompare */
        }

        .ingredient-highlight {
            background: #fff3cd;
            padding: 1px 4px;
            border-radius: 4px;
            font-weight: 600;
            color: #856404;
        }

        .tabs {
            display: flex;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 15px 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }

        .tab:active {
            transform: scale(0.98);
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
            transform: translateY(-2px);
        }

        .legal-status {
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            margin: 10px 0;
        }

        .legal-ok {
            background: #d4edda;
            color: #155724;
        }

        .legal-warning {
            background: #fff3cd;
            color: #856404;
        }

        .legal-danger {
            background: #f8d7da;
            color: #721c24;
        }

        .added-drink {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e1e8ed;
        }

        .added-drink button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 8px;
            cursor: pointer;
        }

        .total-alcol {
            font-weight: bold;
            margin-top: 10px;
            text-align: right;
        }

        .fitness-info {
            background: #e8f8f4;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
            font-size: 12px;
            color: #0c5460;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .content {
                padding: 20px 15px;
            }

            .form-group { margin-bottom: 15px; }
            input, select { font-size: 14px; padding: 12px; }
            .cocktail-list { max-height: 250px; overflow-y: auto; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Gradazione Alcolica</h1>
            <p>Calcola gradazione e alcolemia dei cocktail</p>
        </div>
        
        <div class="content">
            <div class="tabs">
                <div class="tab active" data-section="search"><i class="fas fa-search"></i> Cerca</div>
                <div class="tab" data-section="alcolemia"><i class="fas fa-flask"></i> Alcolemia</div>
                <div class="tab" data-section="lista"><i class="fas fa-list"></i> Lista</div>
            </div>

            <!-- Sezione Ricerca Cocktail -->
            <div id="search" class="section active">
                <div class="form-group">
                    <label>Cerca un cocktail</label>
                    <input type="text" id="searchInput" placeholder="Es: Negroni, Spritz Aperol..." aria-label="Cerca cocktail">
                </div>
                
                <!-- Filtri di ricerca -->
                <div class="search-filters" id="searchFilters">
                    <div class="filter-chip active" data-filter="nome">Nome</div>
                    <div class="filter-chip" data-filter="ingredienti">Ingredienti</div>
                    <div class="filter-chip" data-filter="categoria">Categoria</div>
                </div>

                <div class="search-stats" id="searchStats"></div>

                <div id="searchResults"></div>
            </div>

            <!-- Sezione Calcolo Alcolemia -->
            <div id="alcolemia" class="section">
                <div class="form-group">
                    <label>Inserisci nome cocktail</label>
                    <input type="text" id="cocktailName" placeholder="Nome cocktail...">
                </div>

                <div class="form-group">
                    <input type="number" id="quantita" placeholder="Quantità (default 1)" min="1" value="1">
                </div>

                <button class="btn btn-secondary" id="aggiungiDrinkBtn">Aggiungi Drink</button>

                <div id="addedDrinks" class="cocktail-list"></div>

                <div class="total-alcol">Totale alcol puro: <span id="totalAlcol">0</span> g</div>

                <div id="cocktailInfo" style="display: none;">
                    <div class="results">
                        <div class="result-item">
                            <span class="result-label">Gradazione:</span>
                            <span class="result-value" id="gradazione">-</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Alcol puro:</span>
                            <span class="result-value" id="alcolPuro">-</span>
                        </div>
                    </div>
                </div>

                <!-- Dati personali -->
                <div class="form-group">
                    <label>I tuoi dati</label>
                    <select id="genere">
                        <option value="uomo">Uomo</option>
                        <option value="donna">Donna</option>
                    </select>
                </div>

                <div class="form-group">
                    <input type="number" id="peso" placeholder="Peso (kg)" min="30" max="200">
                </div>

                <div class="form-group">
                    <input type="number" id="altezza" placeholder="Altezza (cm)" min="120" max="250">
                </div>

                <div class="form-group">
                    <input type="number" id="eta" placeholder="Età (anni)" min="14" max="110">
                </div>

                <!-- Fitness -->
                <div class="form-group">
                    <label>Livello di forma fisica</label>
                    <select id="fitnessLevel">
                        <option value="sedentario">Sedentario</option>
                        <option value="attivo">Attivo (~2 allenamenti/settimana)</option>
                        <option value="atleta">Atleta (5+ allenamenti/settimana)</option>
                    </select>
                    <div class="fitness-info">
                        L'allenamento migliora il metabolismo (+5/10%)
                    </div>
                    <div id="esercizioSameDayGroup" class="form-group" style="display: none;">
                        <label>Allenato oggi?</label>
                        <select id="esercizioSameDay">
                            <option value="no">No</option>
                            <option value="si">Sì</option>
                        </select>
                    <div class="fitness-info">Esercizio acuto rallenta metabolismo (-1.0%, fino 24h)</div>
                </div>
                </div>

                <!-- Acqua bevuta -->
                <div class="form-group">
                    <label>Idratazione durante bevuta</label>
                    <select id="idratazione">
                        <option value="assente">Assente</option>
                        <option value="bassa" selected="selected">Bassa (< 100 ml)</option>
                        <option value="media">Media (300 ml)</option>
                        <option value="alta">Alta (> 1000 ml)</option>
                    </select>
                    <div class="fitness-info">Bere acqua pura diluisce l'alcol (±2.5/5% BAC) <br> Con 3+ cocktail e no idratazione attiva scegli "bassa"</div>
                </div>

                <!-- Stato dello stomaco -->
                <div class="form-group">
                    <label>Stomaco</label>
                    <select id="stomaco">
                        <option value="false">Vuoto</option>
                        <option value="true">Pieno</option>
                    </select>
                </div>

                <!-- Sessione bevuta -->
                <div class="form-group">
                    <label>Durata totale sessione (minuti)</label>
                    <input type="number" id="durataMinuti" placeholder="Es: 120 per 2 ore" min="0">
                </div>

                <div class="form-group">
                    <label>Minuti passati dal primo drink</label>
                    <input type="number" id="minutiPrimo" placeholder="Es: 180 per 3 ore fa" min="0">
                    <div class="fitness-info">Durante la bevuta, il BAC aumenta; dopo, diminuisce.</div>
                </div>

                <button class="btn" id="calcolaBtn">Calcola Alcolemia</button>

                <div id="alcolemiaResults"></div>
            </div>

            <!-- Sezione Lista Cocktail -->
            <div id="lista" class="section">
                <div class="search-box">
                    <input type="text" id="filterInput" placeholder="Filtra cocktail...">
                </div>
                <div class="cocktail-list" id="cocktailList"></div>
            </div>
        </div>
        <!-- Copyright -->
        <div style="text-align: center; padding: 15px 20px; font-size: 11px; color: #888; border-top: 1px solid #e1e8ed; background: rgba(248,249,250,0.5);">
            © 2025 Tommaso Merici - Alcohol Gradation & BAC Estimator
        </div>
    </div>

    <script>
        // Database cocktail completo. Classificazioni IBA rivisitate.
        const cocktailDatabase = [
            // Cocktail Classic (The Unforgettables) 24
            {nome: "Alexander", categoria: "Classic", ingredienti: [{nome: "Cognac", volume: 30, gradazione: 40}, {nome: "Crème de Cacao (Brown)", volume: 30, gradazione: 24}, {nome: "Fresh Cream", volume: 30, gradazione: 0}], bicchiere: 120, note: "Servito con noce moscata fresca macinata"},
            {nome: "Americano", categoria: "Classic", ingredienti: [{nome: "Campari", volume: 60, gradazione: 25}, {nome: "Vermouth Rosso", volume: 60, gradazione: 16}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e mezza fetta d'arancia"},
            {nome: "Aviation", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Maraschino", volume: 15, gradazione: 30}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Crème de Violette", volume: 1, gradazione: 20}], bicchiere: 120, note: "Servito in coppa cocktail"},
            {nome: "Boulevardier", categoria: "Classic", ingredienti: [{nome: "Bourbon", volume: 40, gradazione: 40}, {nome: "Campari", volume: 60, gradazione: 25}, {nome: "Vermouth Rosso", volume: 60, gradazione: 16}], bicchiere: 250, note: "Versione whiskey del Negroni. <br> IBA vorrebbe 45, 30, 30."},
            {nome: "Clover Club", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Sciroppo di Lampone", volume: 15, gradazione: 0}, {nome: "Albume", volume: 15, gradazione: 0}], bicchiere: 120, note: "Servito con schiuma rosa"},
            {nome: "Daiquiri", categoria: "Classic", ingredienti: [{nome: "Rum Bianco", volume: 60, gradazione: 40}, {nome: "Succo di Lime", volume: 20, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 10, gradazione: 0}], bicchiere: 110, note: "Shakerato e servito up"},                        
            {nome: "Dirty Martini", categoria: "Classic", ingredienti: [{nome: "Gin o Vodka", volume: 60, gradazione: 40}, {nome: "Vermouth Secco", volume: 10, gradazione: 18}, {nome: "Acqua di Oliva", volume: 10, gradazione: 0}], bicchiere: 120, note: "Gin o Vodka a scelta; <br> Guarnizione: olive verdi; <br> Metodo: mescolato o shakerato; <br> Coppa Martini ben fredda"},
            {nome: "Dry Martini", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 60, gradazione: 40}, {nome: "Vermouth Secco", volume: 10, gradazione: 18}], bicchiere: 120, note: "Gin e Vermouth (Martini Dry/Extra Dry) a scelta; <br> Guarnizione: olive verdi (in salamoia o meno) o scorza di limone; <br> Metodo: mescolato (stirred) o shakerato (shaken); <br> Coppa Martini ben fredda"},
            {nome: "Gin Fizz", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Succo di Lime", volume: 15, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 10, gradazione: 0}, {nome: "Soda Water", volume: 45, gradazione: 0}], bicchiere: 200, note: "Servire senza ghiaccio (IBA)"},
            {nome: "Gin Lemon", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 50, gradazione: 40}, {nome: "Limonata", volume: 150, gradazione: 0}], bicchiere: 250, note: "Servito con fette di limone"},
            {nome: "Gin Soda e Lime", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 50, gradazione: 40}, {nome: "Soda Water", volume: 150, gradazione: 0}, {nome: "Succo di Lime", volume: 15, gradazione: 0}], bicchiere: 250, note: "Servito con fette di lime"},
            {nome: "Gin Tonic", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 50, gradazione: 40}, {nome: "Acqua Tonica", volume: 150, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e lime o scorza di limone"},
            {nome: "Manhattan", categoria: "Classic", ingredienti: [{nome: "Whiskey", volume: 50, gradazione: 40}, {nome: "Vermouth Rosso", volume: 20, gradazione: 17}, {nome: "Angostura Bitter", volume: 1, gradazione: 44.7}], bicchiere: 120, note: "Servito con ciliegia"},
            {nome: "Martinez", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Vermouth Rosso", volume: 45, gradazione: 17}, {nome: "Maraschino Luxardo", volume: 5, gradazione: 40}, {nome: "Orange Bitters", volume: 1, gradazione: 28}], bicchiere: 120, note: "Servito con scorza di limone"},
            {nome: "Negroni", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 30, gradazione: 40}, {nome: "Campari", volume: 30, gradazione: 25}, {nome: "Vermouth Rosso", volume: 30, gradazione: 16}], bicchiere: 200, note: "Servito con ghiaccio e scorza d'arancia"},
            {nome: "Negroni Bianco", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 30, gradazione: 40}, {nome: "Lillet Blanc", volume: 30, gradazione: 17}, {nome: "Vermouth Bianco (Dry)", volume: 30, gradazione: 18}], bicchiere: 200, note: "Servito con ghiaccio e scorza di limone"},
            {nome: "Negroni Sbagliato", categoria: "Classic", ingredienti: [{nome: "Prosecco", volume: 30, gradazione: 11.5}, {nome: "Vermouth Rosso", volume: 30, gradazione: 16}, {nome: "Campari", volume: 30, gradazione: 25}], bicchiere: 200, note: "Versione con Prosecco al posto del gin"},
            {nome: "Novebuche", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Campari", volume: 30, gradazione: 25}, {nome: "Succo di Pompelmo", volume: 60, gradazione: 0}], bicchiere: 200, note: "Servito con ghiaccio"},
            {nome: "Old Fashioned", categoria: "Classic", ingredienti: [{nome: "Whiskey", volume: 45, gradazione: 40}, {nome: "Zucchero", volume: 10, gradazione: 0}, {nome: "Angostura Bitter", volume: 2, gradazione: 44.7}, {nome: "Acqua", volume: 10, gradazione: 0}], bicchiere: 120, note: "Servito con ghiaccio e scorza arancia"},
            {nome: "Sazerac", categoria: "Classic", ingredienti: [{nome: "Whiskey Rye", volume: 50, gradazione: 40}, {nome: "Zucchero", volume: 5, gradazione: 0}, {nome: "Peychaud's Bitters", volume: 3, gradazione: 35}, {nome: "Assenzio", volume: 2, gradazione: 68}], bicchiere: 120, note: "Cocktail storico di New Orleans"},
            {nome: "Vodka Martini", categoria: "Classic", ingredienti: [{nome: "Vodka", volume: 60, gradazione: 40}, {nome: "Vermouth Secco", volume: 10, gradazione: 18}], bicchiere: 120, note: "Vodka e Vermouth a scelta; Guarnizione: olive verdi o scorza di limone; Metodo: mescolato o shakerato; Coppa Martini ben fredda"},
            {nome: "Whiskey Soda", categoria: "Classic", ingredienti: [{nome: "Whiskey", volume: 50, gradazione: 40}, {nome: "Soda Water", volume: 150, gradazione: 0}], bicchiere: 200, note: "Highball classico con limone"},
            {nome: "Whiskey Sour", categoria: "Classic", ingredienti: [{nome: "Whiskey", volume: 45, gradazione: 40}, {nome: "Succo di Limone", volume: 25, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 20, gradazione: 0}], bicchiere: 200, note: "Opzionale albume d'uovo"},
            {nome: "White Lady", categoria: "Classic", ingredienti: [{nome: "Gin", volume: 40, gradazione: 40}, {nome: "Triple Sec", volume: 30, gradazione: 30}, {nome: "Succo di Limone", volume: 15, gradazione: 0}], bicchiere: 120, note: "Servito in coppa cocktail"},

            // Cocktail Contemporary Classics (The Contemporary) 33
            {nome: "Black Russian", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 50, gradazione: 40}, {nome: "Kahlúa", volume: 25, gradazione: 20}], bicchiere: 200, note: "Servito con ghiaccio"},
            {nome: "Bloody Mary", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 45, gradazione: 40}, {nome: "Succo di Pomodoro", volume: 90, gradazione: 0}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Salsa Worcestershire", volume: 2, gradazione: 0}, {nome: "Tabasco", volume: 1, gradazione: 0}, {nome: "Sale", volume: 1, gradazione: 0}], bicchiere: 250, note: "Servito con sedano e spezie"},
            {nome: "Caipirão", categoria: "Contemporary", ingredienti: [{nome: "Licor Beirão", volume: 60, gradazione: 22}, {nome: "Lime", volume: 30, gradazione: 0}, {nome: "Zucchero di Canna", volume: 20, gradazione: 0}], bicchiere: 200, note: "Pestare lime e zucchero"},
            {nome: "Caipirinha", categoria: "Contemporary", ingredienti: [{nome: "Cachaça", volume: 60, gradazione: 45}, {nome: "Lime", volume: 30, gradazione: 0}, {nome: "Zucchero di Canna", volume: 20, gradazione: 0}], bicchiere: 200, note: "Pestare lime e zucchero"},
            {nome: "Caipirissima", categoria: "Contemporary", ingredienti: [{nome: "Rum", volume: 60, gradazione: 40}, {nome: "Lime", volume: 30, gradazione: 0}, {nome: "Zucchero di Canna", volume: 20, gradazione: 0}], bicchiere: 200, note: "Pestare lime e zucchero"},
            {nome: "Caipiroska", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 60, gradazione: 40}, {nome: "Lime", volume: 30, gradazione: 0}, {nome: "Zucchero di Canna", volume: 20, gradazione: 0}], bicchiere: 200, note: "Pestare lime e zucchero"},
            {nome: "Caipiroska variante frutta", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 40, gradazione: 40}, {nome: "Liquore alla frutta", volume: 20, gradazione: 20}, {nome: "Lime", volume: 30, gradazione: 0}, {nome: "Zucchero di Canna", volume: 20, gradazione: 0}], bicchiere: 200, note: "Varianti alla frutta: fragola, maracuja (passion fruit), mango, ananas, pesca, lampone"},
            {nome: "Cardinale", categoria: "Contemporary", ingredienti: [{nome: "Gin", volume: 40, gradazione: 40}, {nome: "Vermouth Secco", volume: 20, gradazione: 18}, {nome: "Campari", volume: 10, gradazione: 25}], bicchiere: 120, note: "Servito con scorza di limone"},
            {nome: "Corpse Reviver #2", categoria: "Contemporary", ingredienti: [{nome: "Gin", volume: 22.5, gradazione: 40}, {nome: "Cointreau", volume: 22.5, gradazione: 40}, {nome: "Lillet Blanc", volume: 22.5, gradazione: 17}, {nome: "Succo di Limone", volume: 22.5, gradazione: 0}, {nome: "Assenzio", volume: 1, gradazione: 68}], bicchiere: 120, note: "Servito con scorza limone"},
            {nome: "Cosmopolitan", categoria: "Contemporary", ingredienti: [{nome: "Vodka Citron", volume: 40, gradazione: 40}, {nome: "Triple Sec (Cointreau)", volume: 15, gradazione: 40}, {nome: "Succo di Lime", volume: 15, gradazione: 0}, {nome: "Succo di Mirtillo", volume: 30, gradazione: 0}], bicchiere: 150, note: "Servito in coppa Martini"},
            {nome: "Cuba Libre", categoria: "Contemporary", ingredienti: [{nome: "Rum", volume: 50, gradazione: 40}, {nome: "Cola", volume: 120, gradazione: 0}, {nome: "Succo di Lime", volume: 10, gradazione: 0}], bicchiere: 200, note: "Servito con ghiaccio e lime"},
            {nome: "French 75", categoria: "Contemporary", ingredienti: [{nome: "Gin", volume: 30, gradazione: 40}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 15, gradazione: 0}, {nome: "Champagne", volume: 60, gradazione: 12}], bicchiere: 150, note: "Servito in flute"},
            {nome: "French Connection", categoria: "Contemporary", ingredienti: [{nome: "Cognac", volume: 35, gradazione: 40}, {nome: "Amaretto", volume: 35, gradazione: 28}], bicchiere: 120, note: "Servito con ghiaccio"},
            {nome: "Garibaldi", categoria: "Contemporary", ingredienti: [{nome: "Campari", volume: 45, gradazione: 25}, {nome: "Succo d'arancia", volume: 120, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e scorza di arancia"},
            {nome: "Hemingway Special", categoria: "Contemporary", ingredienti: [{nome: "Rum", volume: 60, gradazione: 40}, {nome: "Succo di Pompelmo", volume: 40, gradazione: 0}, {nome: "Succo di Lime", volume: 15, gradazione: 0}, {nome: "Maraschino (Luxardo)", volume: 15, gradazione: 40}], bicchiere: 150, note: "Servito in coppa cocktail"},
            {nome: "Irish Coffee", categoria: "Contemporary", ingredienti: [{nome: "Whiskey Irlandese", volume: 50, gradazione: 40}, {nome: "Caffè", volume: 120, gradazione: 0}, {nome: "Zucchero", volume: 10, gradazione: 0}, {nome: "Panna", volume: 50, gradazione: 0}], bicchiere: 200, note: "Servito caldo con panna montata"},
            {nome: "Lemon Drop Martini", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 30, gradazione: 40}, {nome: "Triple Sec", volume: 20, gradazione: 30}, {nome: "Succo di Limone", volume: 15, gradazione: 0}], bicchiere: 120, note: "A scelta, servito con zucchero sul bordo"},
            {nome: "London Mule", categoria: "Contemporary", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Ginger Beer", volume: 120, gradazione: 0}, {nome: "Succo di Lime", volume: 10, gradazione: 0}], bicchiere: 200, note: "Servito in tazza di rame"},
            {nome: "Long Island", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 15, gradazione: 40}, {nome: "Rum Bianco", volume: 15, gradazione: 40}, {nome: "Gin", volume: 15, gradazione: 40}, {nome: "Tequila", volume: 15, gradazione: 40}, {nome: "Triple Sec", volume: 15, gradazione: 30}], bicchiere: 200, note: "Completare con Cola"},
            {nome: "Long Island Iced Tea", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 15, gradazione: 40}, {nome: "Rum Bianco", volume: 15, gradazione: 40}, {nome: "Gin", volume: 15, gradazione: 40}, {nome: "Tequila", volume: 15, gradazione: 40}, {nome: "Triple Sec", volume: 15, gradazione: 30}, {nome: "Succo di Limone", volume: 25, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 30, gradazione: 0}, {nome: "Cola", volume: 60, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e fetta di limone (opzionale)"},
            {nome: "Mai Tai", categoria: "Contemporary", ingredienti: [{nome: "Rum Scuro (Amber Jamaican)", volume: 30, gradazione: 40}, {nome: "Rum Bianco (Martinique Molasses)", volume: 30, gradazione: 40}, {nome: "Triple Sec (Orange Curacao)", volume: 15, gradazione: 25}, {nome: "Sciroppo d'Orzata", volume: 15, gradazione: 0}, {nome: "Succo di Lime", volume: 30, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 7.5, gradazione: 0}], bicchiere: 200, note: "Servito con ananas, foglie di menta e scorza di lime"},
            {nome: "Margarita", categoria: "Contemporary", ingredienti: [{nome: "Agave Tequila", volume: 50, gradazione: 42.5}, {nome: "Triple Sec", volume: 20, gradazione: 30}, {nome: "Succo di Lime", volume: 15, gradazione: 0}], bicchiere: 200, note: "Servito con metà bordo salato (opzionale)"},
            {nome: "Mimosa", categoria: "Contemporary", ingredienti: [{nome: "Champagne", volume: 75, gradazione: 12}, {nome: "Succo d'Arancia", volume: 75, gradazione: 0}], bicchiere: 180, note: "Servito in flute"},
            {nome: "Mint Julep", categoria: "Contemporary", ingredienti: [{nome: "Bourbon", volume: 60, gradazione: 40}, {nome: "Zucchero a Velo", volume: 5, gradazione: 0}, {nome: "Acqua", volume: 10, gradazione: 0}], bicchiere: 200, note: "Servito con ghiaccio tritato e 4 rametti di menta fresca"},
            {nome: "Mojito", categoria: "Contemporary", ingredienti: [{nome: "Rum Bianco (Cubano)", volume: 45, gradazione: 40}, {nome: "Menta", volume: 10, gradazione: 0}, {nome: "Zucchero di Canna Bianco", volume: 10, gradazione: 0}, {nome: "Lime", volume: 20, gradazione: 0}, {nome: "Soda Water", volume: 100, gradazione: 0}], bicchiere: 250, note: "Pestare menta e zucchero"},
            {nome: "Moscow Mule", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 45, gradazione: 40}, {nome: "Ginger Beer", volume: 120, gradazione: 0}, {nome: "Succo di Lime", volume: 10, gradazione: 0}], bicchiere: 200, note: "Servito in tazza di rame"},
            {nome: "Piña Colada", categoria: "Contemporary", ingredienti: [{nome: "Rum Bianco", volume: 50, gradazione: 40}, {nome: "Latte di Cocco", volume: 30, gradazione: 0}, {nome: "Succo di Ananas", volume: 50, gradazione: 0}], bicchiere: 200, note: "Servito con una fetta di ananas e una ciliegina da cocktail"},
            {nome: "Pisco Sour", categoria: "Contemporary", ingredienti: [{nome: "Pisco", volume: 60, gradazione: 45}, {nome: "Succo di Limone", volume: 30, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 20, gradazione: 0}, {nome: "Albume", volume: 15, gradazione: 0}, {nome: "Angostura bitter", volume: 2, gradazione: 44.7}], bicchiere: 150, note: "Servito con schiuma"},
            {nome: "Sex on the Beach", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 40, gradazione: 40}, {nome: "Peach Schnapps", volume: 20, gradazione: 12}, {nome: "Succo d'Arancia", volume: 40, gradazione: 0}, {nome: "Succo di Mirtillo", volume: 40, gradazione: 0}], bicchiere: 200, note: "Servito con ghiaccio"},
            {nome: "Tequila Sunrise", categoria: "Contemporary", ingredienti: [{nome: "Tequila", volume: 45, gradazione: 40}, {nome: "Succo d'Arancia", volume: 90, gradazione: 0}, {nome: "Sciroppo di Granatina", volume: 15, gradazione: 0}], bicchiere: 200, note: "Servito con gradiente di colore"},
            {nome: "Vesper", categoria: "Contemporary", ingredienti: [{nome: "Gin", volume: 45, gradazione: 40}, {nome: "Vodka", volume: 15, gradazione: 40}, {nome: "Lillet Blanc", volume: 7.5, gradazione: 17}], bicchiere: 150, note: "Servito con scorza di limone"},
            {nome: "White Russian", categoria: "Contemporary", ingredienti: [{nome: "Vodka", volume: 50, gradazione: 40}, {nome: "Kahlúa", volume: 25, gradazione: 20}, {nome: "Panna", volume: 25, gradazione: 0}], bicchiere: 200, note: "Versione cremosa del Black Russian"},
            {nome: "Zombie", categoria: "Contemporary", ingredienti: [{nome: "Rum Bianco (Gold Puerto Rican)", volume: 45, gradazione: 40}, {nome: "Rum Scuro (Jamaican)", volume: 45, gradazione: 40}, {nome: "Rum Agricolo (Demerara)", volume: 30, gradazione: 43}, {nome: "Succo di Lime", volume: 20, gradazione: 0}, {nome: "Falernum", volume: 15, gradazione: 11}, {nome: "Donn’s Mix", volume: 15, gradazione: 0}, {nome: "Sciroppo di Granatina", volume: 5, gradazione: 0}, {nome: "Angostura bitter", volume: 1, gradazione: 44.7}, {nome: "Liquore all'anice (Pernod)", volume: 0.3, gradazione: 40}], bicchiere: 200, note: "Servire con foglie di menta"},

            // Cocktail New Era (The New Era) 30
            {nome: "Bee's Knees", categoria: "New Era", ingredienti: [{nome: "Gin", volume: 52.5, gradazione: 40}, {nome: "Sciroppo al Miele", volume: 10, gradazione: 0}, {nome: "Succo di Limone", volume: 22.5, gradazione: 0}, {nome: "Succo d'Arancia", volume: 22.5, gradazione: 0}], bicchiere: 120, note: "Guarnizione facoltativa con una scorza di limone o di arancia"},
            {nome: "Bramble", categoria: "New Era", ingredienti: [{nome: "Gin", volume: 50, gradazione: 40}, {nome: "Succo di Limone", volume: 25, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 12.5, gradazione: 0}, {nome: "Crème de Mure", volume: 15, gradazione: 16}], bicchiere: 120, note: "Guarnizione facoltativa con una fetta di limone e more fresche"},
            {nome: "Cedro Tonic", categoria: "New Era", ingredienti: [{nome: "Acqua di Cedro", volume: 50, gradazione: 29}, {nome: "Acqua Tonica", volume: 150, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e scorza di cedro. Acqua di Cedro è un liquore fruttato distillato da Nardini"},
            {nome: "Chartreuse Swizzle", categoria: "New Era", ingredienti: [{nome: "Green Chartreuse", volume: 45, gradazione: 55}, {nome: "Succo di Lime", volume: 22.5, gradazione: 0}, {nome: "Sciroppo d'Ananas", volume: 30, gradazione: 0}, {nome: "Liquore speziato (Falernum)", volume: 15, gradazione: 11}], bicchiere: 150, note: "Guarnizione con foglie di menta e noce moscata grattugiata"},
            {nome: "Dark 'n' Stormy", categoria: "New Era", ingredienti: [{nome: "Rum Scuro (Goslings)", volume: 60, gradazione: 75.5}, {nome: "Ginger Beer", volume: 100, gradazione: 0}, {nome: "Succo di Lime", volume: 10, gradazione: 0}], bicchiere: 200, note: "Guarnizione con uno spicchio di lime o una fetta di lime. Trademark di Gosling's"},
            {nome: "Don's Special Daiquiri", categoria: "New Era", ingredienti: [{nome: "Gold Jamaican Rum", volume: 30, gradazione: 40}, {nome: "Cuban Rum", volume: 15, gradazione: 40}, {nome: "Succo di Lime", volume: 15, gradazione: 0}, {nome: "Sciroppo al Passion Fruit", volume: 15, gradazione: 0}, {nome: "Sciroppo al Miele", volume: 15, gradazione: 0}], bicchiere: 150, note: "Guarnizione con 1/2 passion fruit. Servito con ghiaccio tritato"},
            {nome: "Espresso Martini", categoria: "New Era", ingredienti: [{nome: "Vodka", volume: 50, gradazione: 40}, {nome: "Kahlúa", volume: 30, gradazione: 16}, {nome: "Espresso", volume: 25, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 10, gradazione: 0}], bicchiere: 130, note: "Servito con 3 chicchi di caffè"},
            {nome: "Fernandito", categoria: "New Era", ingredienti: [{nome: "Fernet Branca", volume: 50, gradazione: 39}, {nome: "Cola", volume: 150, gradazione: 0}], bicchiere: 200, note: "Servito con ghiaccio e fetta di limone (opzionale)"},
            {nome: "French Martini", categoria: "New Era", ingredienti: [{nome: "Vodka", volume: 45, gradazione: 40}, {nome: "Liquore di Lamponi (Chambord)", volume: 15, gradazione: 16.5}, {nome: "Succo di Ananas", volume: 15, gradazione: 0}], bicchiere: 100, note: "Spremere l'olio dalla buccia di limone sulla bevanda. Servito in coppa cocktail"},
            {nome: "Gimlet", categoria: "New Era", ingredienti: [{nome: "Gin", volume: 60, gradazione: 40}, {nome: "Cordiale di Lime", volume: 30, gradazione: 0}], bicchiere: 120, note: "Servito ghiacciato. Possibile sostituzione del Gin con Vodka"},
            {nome: "Gin Basil Smash", categoria: "New Era", ingredienti: [{nome: "Gin", volume: 60, gradazione: 40}, {nome: "Basilico Fresco", volume: 5, gradazione: 0}, {nome: "Succo di Limone", volume: 22.5, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 22.5, gradazione: 0}], bicchiere: 180, note: "Pestare basilico e zucchero"},
            {nome: "Grand Margarita", categoria: "New Era", ingredienti: [{nome: "Agave Tequila", volume: 45, gradazione: 42.5}, {nome: "Grand Marnier", volume: 30, gradazione: 40}, {nome: "Succo di Lime", volume: 15, gradazione: 0}], bicchiere: 200, note: "Guarnizione con una fetta di lime"},
            {nome: "Hot Toddy", categoria: "New Era", ingredienti: [{nome: "Whiskey", volume: 50, gradazione: 40}, {nome: "Miele", volume: 10, gradazione: 0}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Acqua Calda", volume: 120, gradazione: 0}], bicchiere: 250, note: "Drink caldo invernale. Aggiungere spezie come Cannella e Chiodi di Garofano"},
            {nome: "Iba Tiki", categoria: "New Era", ingredienti: [{nome: "Rum Bianco (Profundo Havana Club)", volume: 30, gradazione: 35}, {nome: "Rum Scuro (Smoky Havana Club)", volume: 30, gradazione: 40}, {nome: "Amaretto", volume: 15, gradazione: 28}, {nome: "Liquore alle Nocciole (Frangelico)", volume: 5, gradazione: 36.5}, {nome: "Maraschino (Luxardo)", volume: 3, gradazione: 40}, {nome: "Purea di Passion Fruit", volume: 30, gradazione: 0}, {nome: "Succo d'Ananas", volume: 90, gradazione: 0}, {nome: "Succo di Lime", volume: 30, gradazione:0}], bicchiere: 300, note: "Guarnizione con agrumi e una fetta d'ananas disidratato"},
            {nome: "Jager Bomb", categoria: "New Era", ingredienti: [{nome: "Jägermeister", volume: 50, gradazione: 35}, {nome: "Energy Drink", volume: 150, gradazione: 0}], bicchiere: 250, note: "Preferibilmente servito con un bicchierino di Jägermeister da far cadere nell'energy drink"},
            {nome: "Naked and Famous", categoria: "New Era", ingredienti: [{nome: "Mezcal", volume: 22.5, gradazione: 60}, {nome: "Aperol", volume: 22.5, gradazione: 11}, {nome: "Yellow Chartreuse", volume: 22.5, gradazione: 43}, {nome: "Succo di Limone", volume: 22.5, gradazione: 0}], bicchiere: 120, note: "Cocktail affumicato e agrumato"},
            {nome: "New York Sour", categoria: "New Era", ingredienti: [{nome: "Whiskey", volume: 60, gradazione: 41.5}, {nome: "Succo di Limone", volume: 30, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 22.5, gradazione: 0}, {nome: "Vino Rosso", volume: 15, gradazione: 13.5}], bicchiere: 200, note: "Aggiungere alcune gocce di albume d'uovo. Guarnizione con scorza di limone o arancia e ciliegia"},
            {nome: "Old Cuban", categoria: "New Era", ingredienti: [{nome: "Rum Scuro (Aged)", volume: 45, gradazione: 40}, {nome: "Champagne/Prosecco (Brut)", volume: 60, gradazione: 12}, {nome: "Succo di Lime", volume: 22.5, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 30, gradazione: 0}, {nome: "Angostura bitter", volume: 1, gradazione: 44.7}], bicchiere: 200, note: "Guarnizione con menta fresca e scorza di lime"},
            {nome: "Painkiller", categoria: "New Era", ingredienti: [{nome: "Rum Scuro (Pusser's)", volume: 60, gradazione: 40}, {nome: "Succo di Ananas", volume: 60, gradazione: 0}, {nome: "Succo d'Arancia", volume: 30, gradazione: 0}, {nome: "Latte di Cocco", volume: 30, gradazione: 0}], bicchiere: 250, note: "Guarnizione con noce moscata grattuggiata"},          
            {nome: "Paloma", categoria: "New Era", ingredienti: [{nome: "Agave Tequila", volume: 50, gradazione: 42.5}, {nome: "Pink Grapefruit Soda", volume: 100, gradazione: 0}, {nome: "Succo di Lime", volume: 5, gradazione: 0}], bicchiere: 250, note: "Servito con sale sul bordo"},
            {nome: "Paper Plane", categoria: "New Era", ingredienti: [{nome: "Bourbon", volume: 30, gradazione: 40}, {nome: "Aperol", volume: 30, gradazione: 11}, {nome: "Amaro Nonino", volume: 30, gradazione: 35}, {nome: "Succo di Limone", volume: 30, gradazione: 0}], bicchiere: 150, note: "Un tempo pensato con il Campari; rivisitazione del cocktail Last Word"},
            {nome: "Porn Star Martini", categoria: "New Era", ingredienti: [{nome: "Vanilla Vodka", volume: 50, gradazione: 38}, {nome: "Liquore al Passion Fruit", volume: 20, gradazione: 17}, {nome: "Purea di Passion Fruit", volume: 50, gradazione: 0}, {nome: "Sciroppo alla Vaniglia", volume: 10, gradazione: 0}, {nome: "Champagne", volume: 50, gradazione: 12.2}], bicchiere: 150, note: "Accompagnare con un bicchierino di Champagne (50 ml)"},
            {nome: "Skinny Bitch", categoria: "New Era", ingredienti: [{nome: "Vodka", volume: 40, gradazione: 40}, {nome: "Succo di Lime", volume: 15, gradazione: 0}, {nome: "Soda Water", volume: 150, gradazione: 0}], bicchiere: 250, note: "Versione leggera del Vodka Soda"},
            {nome: "Suffering Bastard", categoria: "New Era", ingredienti: [{nome: "Gin", volume: 30, gradazione: 40}, {nome: "Cognac/Brandy", volume: 30, gradazione: 40}, {nome: "Succo di Limone", volume: 15, gradazione: 0}, {nome: "Ginger Beer", volume: 90, gradazione: 0}], bicchiere: 250, note: "Servito con Ginger Beer a parte"},
            {nome: "Tom Collins", categoria: "New Era", ingredienti: [{nome: "Gin (Old Tom)", volume: 45, gradazione: 40}, {nome: "Succo di Limone", volume: 30, gradazione: 0}, {nome: "Sciroppo di Zucchero", volume: 15, gradazione: 0}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 200, note: "Guarnizione con fetta di limone. Versione lunga del Gin Sour"},
            {nome: "Tommy's Margarita", categoria: "New Era", ingredienti: [{nome: "Agave Tequila", volume: 60, gradazione: 42.5}, {nome: "Succo di Lime", volume: 30, gradazione: 0}, {nome: "Sciroppo di Agave", volume: 30, gradazione: 0}], bicchiere: 150, note: "Versione senza Triple Sec"},
            {nome: "Vieux Carré", categoria: "New Era", ingredienti: [{nome: "Whiskey Rye", volume: 30, gradazione: 40}, {nome: "Cognac", volume: 30, gradazione: 40}, {nome: "Vermouth Rosso", volume: 30, gradazione: 19}, {nome: "Bénédictine", volume: 15, gradazione: 40}, {nome: "Peychaud's Bitters", volume: 2, gradazione: 35}], bicchiere: 150, note: "Prende il nome dal quartiere Vieux Carré, il centro storico più antico di New Orleans"},
            {nome: "Vodka Redbull", categoria: "New Era", ingredienti: [{nome: "Vodka", volume: 50, gradazione: 40}, {nome: "Redbull", volume: 150, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio"},
            {nome: "Vodka Soda", categoria: "New Era", ingredienti: [{nome: "Vodka", volume: 40, gradazione: 40}, {nome: "Soda Water", volume: 150, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e fetta di lime (opzionale)"},
            {nome: "Vodka Tonic", categoria: "New Era", ingredienti: [{nome: "Vodka", volume: 50, gradazione: 40}, {nome: "Acqua Tonica", volume: 150, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e fetta di lime (opzionale)"},

            // APERITIVI
            {nome: "Agua de Valencia", categoria: "Aperitivo", ingredienti: [{nome: "Gin", volume: 5, gradazione: 40}, {nome: "Vodka", volume: 5, gradazione: 40}, {nome: "Succo d'Arancia", volume: 40, gradazione: 0}, {nome: "Cava", volume: 130, gradazione: 11}, {nome: "Zucchero", volume: 5, gradazione: 0}], bicchiere: 250, note: "Cocktail spagnolo originariamente servito in pitcher"},            
            {nome: "Bellini", categoria: "Aperitivo", ingredienti: [{nome: "Prosecco", volume: 100, gradazione: 11}, {nome: "Purè di Pesca", volume: 50, gradazione: 0}], bicchiere: 180, note: "Servito in flute"},
            {nome: "Hugo", categoria: "Aperitivo", ingredienti: [{nome: "Liquore di Fiori di Sambuco (St-Germain)", volume: 40, gradazione: 20}, {nome: "Prosecco", volume: 60, gradazione: 11}, {nome: "Soda Water", volume: 60, gradazione: 0}, {nome: "Menta Fresca", volume: 5, gradazione: 0}], bicchiere: 250, note: "Servito con ghiaccio e lime"},
            {nome: "Leone", categoria: "Aperitivo", ingredienti: [{nome: "Aperitivo Leone", volume: 90, gradazione: 22}, {nome: "Soda Water", volume: 90, gradazione: 0}], bicchiere: 250, note: "Rivisitazione Americano con finale tendenzialmente più dolce - Leon Bar, Bassano del Grappa. Servito con ghiaccio"},
            {nome: "Mezzo e Mezzo", categoria: "Aperitivo", ingredienti: [{nome: "Mezzo e Mezzo", volume: 7.5, gradazione: 22}, {nome: "Soda Water", volume: 7.5, gradazione: 0}], bicchiere: 10, note: "Aperitivo tradizionale della distilleria Nardini, Bassano del Grappa. Preparato miscelando una parte di Mezzoemezzo con una parte di seltz"},
            {nome: "Spritz Aperol", categoria: "Aperitivo", ingredienti: [{nome: "Aperol", volume: 60, gradazione: 11}, {nome: "Prosecco", volume: 60, gradazione: 11}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 250, note: "Servito con fetta d'arancia"},
            {nome: "Spritz Aperol Veneziana", categoria: "Aperitivo", ingredienti: [{nome: "Aperol", volume: 90, gradazione: 11}, {nome: "Prosecco", volume: 90, gradazione: 11}], bicchiere: 250, note: "Spritz Aperol senza soda water"},
            {nome: "Spritz Campari", categoria: "Aperitivo", ingredienti: [{nome: "Campari", volume: 60, gradazione: 25}, {nome: "Prosecco", volume: 60, gradazione: 11}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 250, note: "Spritz classico con Campari"},
            {nome: "Spritz Campari Veneziana", categoria: "Aperitivo", ingredienti: [{nome: "Campari", volume: 90, gradazione: 25}, {nome: "Prosecco", volume: 90, gradazione: 11}], bicchiere: 250, note: "Spritz Campari senza soda water"},
            {nome: "Spritz Cynar", categoria: "Aperitivo", ingredienti: [{nome: "Cynar", volume: 60, gradazione: 16.5}, {nome: "Prosecco", volume: 60, gradazione: 11}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 250, note: "Spritz classico con Cynar"},
            {nome: "Spritz Cynar Veneziana", categoria: "Aperitivo", ingredienti: [{nome: "Cynar", volume: 90, gradazione: 16.5}, {nome: "Prosecco", volume: 90, gradazione: 11}], bicchiere: 250, note: "Spritz Cynar senza soda water"},
            {nome: "Spritz Cynar 70 Proof", categoria: "Aperitivo", ingredienti: [{nome: "Cynar", volume: 60, gradazione: 35}, {nome: "Prosecco", volume: 60, gradazione: 11}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 250, note: "Spritz classico con Cynar"},
            {nome: "Spritz Cynar 70 Proof Veneziana", categoria: "Aperitivo", ingredienti: [{nome: "Cynar", volume: 90, gradazione: 35}, {nome: "Prosecco", volume: 90, gradazione: 11}], bicchiere: 250, note: "Spritz Cynar senza soda water"},
            {nome: "Spritz Liscio", categoria: "Aperitivo", ingredienti: [{nome: "Prosecco", volume: 90, gradazione: 11}, {nome: "Soda Water", volume: 90, gradazione: 0}], bicchiere: 250, note: "Denominato anche Spritz Bianco, è una variante senza bitter dello Spritz classico"},
            {nome: "Spritz Select", categoria: "Aperitivo", ingredienti: [{nome: "Select", volume: 60, gradazione: 17.5}, {nome: "Prosecco", volume: 60, gradazione: 11}, {nome: "Soda Water", volume: 60, gradazione: 0}], bicchiere: 250, note: "Spritz classico con Select"},
            {nome: "Spritz Select Veneziana", categoria: "Aperitivo", ingredienti: [{nome: "Select", volume: 90, gradazione: 17.5}, {nome: "Prosecco", volume: 90, gradazione: 11}], bicchiere: 250, note: "Spritz Select senza soda water"},
            {nome: "Te+", categoria: "Aperitivo", ingredienti: [{nome: "Te+ (Origin Bassano)", volume: 170, gradazione: 9.5}], bicchiere: 250, note: "Estratto alcolico al tè pesca - Origin Bar, Bassano del Grappa"},
            
            // BIRRE
            {nome: "Lager Piccola", categoria: "Birra", ingredienti: [{nome: "Birra Lager", volume: 330, gradazione: 4.8}], bicchiere: 330, note: "Birra chiara tipo Heineken, Stella Artois (ABV medio 4.2-5.4%)"},
            {nome: "Lager Media", categoria: "Birra", ingredienti: [{nome: "Birra Lager", volume: 400, gradazione: 4.8}], bicchiere: 400, note: "Birra chiara tipo Heineken, Stella Artois (ABV medio 4.2-5.4%)"},
            {nome: "Weiss Piccola", categoria: "Birra", ingredienti: [{nome: "Birra Weiss", volume: 330, gradazione: 5.0}], bicchiere: 330, note: "Birra di frumento tipo Paulaner, Erdinger (ABV medio 4.5-5.5%)"},
            {nome: "Weiss Media", categoria: "Birra", ingredienti: [{nome: "Birra Weiss", volume: 400, gradazione: 5.0}], bicchiere: 400, note: "Birra di frumento tipo Paulaner, Erdinger (ABV medio 4.5-5.5%)"},
            {nome: "IPA Piccola", categoria: "Birra", ingredienti: [{nome: "Birra IPA", volume: 330, gradazione: 6.5}], bicchiere: 330, note: "India Pale Ale tipo BrewDog, Baladin (ABV medio 5.5-7.5%)"},
            {nome: "IPA Media", categoria: "Birra", ingredienti: [{nome: "Birra IPA", volume: 400, gradazione: 6.5}], bicchiere: 400, note: "India Pale Ale tipo BrewDog, Baladin (ABV medio 5.5-7.5%)"},
            {nome: "Scura Piccola", categoria: "Birra", ingredienti: [{nome: "Birra Scura", volume: 330, gradazione: 5.2}], bicchiere: 330, note: "Birra scura tipo Guinness, Menabrea (ABV medio 4-6%)"},
            {nome: "Scura Media", categoria: "Birra", ingredienti: [{nome: "Birra Scura", volume: 400, gradazione: 5.2}], bicchiere: 400, note: "Birra scura tipo Guinness, Menabrea (ABV medio 4-6%)"},
            {nome: "Doppio Malto Piccola", categoria: "Birra", ingredienti: [{nome: "Birra Doppio Malto", volume: 330, gradazione: 8}], bicchiere: 330, note: "Birra forte tipo Chimay, Duvel (ABV medio 7-9%)"},
            {nome: "Doppio Malto Media", categoria: "Birra", ingredienti: [{nome: "Birra Doppio Malto", volume: 400, gradazione: 8}], bicchiere: 400, note: "Birra forte tipo Chimay, Duvel (ABV medio 7-9%)"},
            
            // VINI - Standard
            {nome: "Vino Rosso", categoria: "Vino", ingredienti: [{nome: "Vino Rosso", volume: 135, gradazione: 13.5}], bicchiere: 350, note: "Calice standard vino rosso tipo Chianti, Barolo, Sangiovese (ABV medio 12-15%)"},
            {nome: "Vino Bianco", categoria: "Vino", ingredienti: [{nome: "Vino Bianco", volume: 120, gradazione: 12.5}], bicchiere: 300, note: "Calice standard vino bianco tipo Pinot Grigio, Chardonnay, Sauvignon (ABV medio 11-14%)"},
            {nome: "Vino Rosato", categoria: "Vino", ingredienti: [{nome: "Vino Rosato", volume: 120, gradazione: 12.0}], bicchiere: 300, note: "Calice standard vino rosato tipo Cerasuolo, Rosé di Provenza (ABV medio 11-13.5%)"},
            {nome: "Prosecco", categoria: "Vino", ingredienti: [{nome: "Prosecco", volume: 100, gradazione: 11.0}], bicchiere: 180, note: "Flute standard prosecco tipo Valdobbiadene, Conegliano, Cartizze (ABV medio 10.5-12%)"},
            {nome: "Champagne", categoria: "Vino", ingredienti: [{nome: "Champagne", volume: 110, gradazione: 12.5}], bicchiere: 180, note: "Flute standard champagne tipo Moët, Dom Pérignon, Veuve Clicquot (ABV medio 12-13%)"},
            {nome: "Vino Dolce", categoria: "Vino", ingredienti: [{nome: "Vino Dolce", volume: 90, gradazione: 7.0}], bicchiere: 200, note: "Vino dolce tipo Moscato (ABV medio 5-9%)"},
            {nome: "Passito", categoria: "Vino", ingredienti: [{nome: "Passito", volume: 70, gradazione: 16.0}], bicchiere: 200, note: "Passito standard tipo Pantelleria, Sauternes, Malvasia (ABV medio 14-18%)"}
        ];

        let addedDrinks = [];

        // Calcolare il fattore fitness
        function calcolaFattoreFitness(fitnessLevel) {
            // Basato sulle evidenze scientifiche trovate:
            // - Un fisico sano aumenta l'eliminazione dell'alcol
            // - Maggiore massa magra = eliminazione più veloce
            // - Le persone allenate hanno migliore composizione corporea
            
            switch(fitnessLevel) {
                case 'atleta':
                    return 1.10; // +10% di efficienza
                case 'attivo':
                    return 1.05; // +5% di efficienza
                case 'sedentario':
                default:
                    return 1.0;  // Baseline
            }
        }

        // Calcolare adjust TBW per atleti
        // L'alcol si distribuisce principalmente nell'acqua corporea. Le persone allenate hanno:
        // - Più massa muscolare (che contiene ~75% di acqua)
        // - Meno tessuto adiposo (che contiene solo ~10% di acqua)
        // - Quindi a parità di peso, hanno più acqua corporea totale
        function calcolaFattoreTBWAdjust(fitnessLevel) {
            switch(fitnessLevel) {
                case 'atleta':
                    return 1.025;  // +2.5% TBW (massa magra alta)
                case 'attivo':
                    return 1.0125;  // +1.25% TBW
                case 'sedentario':
                default:
                    return 1.0;   // Baseline
            }
        }

        // Calcolare idratazione (acqua)
        function calcolaFattoreTBWIdratazione(idratazione) {
            switch(idratazione) {
                case 'alta':
                    return 1.025;  // +2.5%  (TBW base più alto, dunque BAC iniziale inferiore)
                case 'media':
                    return 1.0125;   // +1.25%  (TBW base più alto, dunque BAC iniziale inferiore)
                case 'bassa':
                    return 1.0;  // Baseline (si presuppone che un minimo d'acqua sia stato bevuto) 
                case 'assente':
                    return 0.99;  // -1.0% (dehyd causa BAC iniziale più alto)
                default:
                    return 1.0;  // Baseline
            }
        }

        // Rate assorbimento (esponenziale, k in 1/min)
        // const ASSORB_RATE_VUOTO = 0.05;  // ~90% in 60min
        // const ASSORB_RATE_PIENO = 0.02;  // ~90% in 150min
        // const SIM_STEP = 5; // Simulazione ogni 5min
        // const MAX_SIM_MIN = 360; // Fino a 6h

        // Funzioni di calcolo
        function calcolaTBW(genere, peso, altezza, eta, fitnessLevel, idratazione) {
            let tbwBase;
            if (genere.toLowerCase() === 'uomo') {
                tbwBase = 2.447 - (0.09516 * eta) + (0.1074 * altezza) + (0.3362 * peso);
            } else {
                tbwBase = -2.097 + (0.1069 * altezza) + (0.2466 * peso);
            }
            const tbwFitnessAdjust = calcolaFattoreTBWAdjust(fitnessLevel);
            const tbwIdratazioneAdjust = calcolaFattoreTBWIdratazione(idratazione);
            return Math.max(tbwBase * tbwFitnessAdjust * tbwIdratazioneAdjust, 1.0); // TBW minimo 1L
        }

        function calcolaFattoreWidmark(genere, peso, altezza, eta, fitnessLevel, idratazione) {
            const tbw = calcolaTBW(genere, peso, altezza, eta, fitnessLevel, idratazione);
            return tbw / peso;
        }

        function calcolaGradazione(ingredienti) {
            let alcolTotale = 0;
            let volumeTotale = 0;

            for (const ing of ingredienti) {
                const alcolPuro = ing.volume * (ing.gradazione / 100);
                alcolTotale += alcolPuro;
                volumeTotale += ing.volume;
            }

            if (volumeTotale === 0) return 0;
            return (alcolTotale / volumeTotale) * 100;
        }

        function calcolaGrammiAlcol(ingredienti, diluizioneFactor = 0.95) {  // Default 5% riduzione per ghiaccio/spreco
            let alcolTotale = 0;
            for (const ing of ingredienti) {
                const alcolPuro = ing.volume * (ing.gradazione / 100) * 0.789; // Densità alcol
                alcolTotale += alcolPuro;
            }
            return alcolTotale * diluizioneFactor;  // Applica fattore
        }

        function formatTime(hoursDecimal) {
            if (hoursDecimal <= 0) return 'Subito';
            const totalMin = Math.round(hoursDecimal * 60);
            if (totalMin < 60) {
                return totalMin + ' minuti';
            } else {
                const hours = Math.floor(totalMin / 60);
                const min = totalMin % 60;
                return hours + ':' + (min < 10 ? '0' + min : min) + ' ore';
            }
        }

        // FUNZIONE PRINCIPALE (con curva assorbimento)
        function calcolaAlcolemiaMultipla(totalGrammiAlcol, genere, peso, altezza, eta, stomacoPieno = false, durataMinuti, minutiPrimo, fitnessLevel = 'sedentario', esercizioSameDay = false, idratazione = 'bassa') {
            const fattoreWidmark = calcolaFattoreWidmark(genere, peso, altezza, eta, fitnessLevel, idratazione);
            // Applicazione del fattore fitness al tasso di eliminazione
            const fattoreFitness = calcolaFattoreFitness(fitnessLevel);
            const betaPerOraBase = 0.16;  // Media unisex 2025
            // Esercizio lo stesso giorno
            const esercizioFactor = esercizioSameDay ? 0.99 : 1.0;  // -1.0% if yes
            // Calcola beta per ora
            const betaPerOra = betaPerOraBase * fattoreFitness * esercizioFactor;
            const betaPerMinuto = betaPerOra / 60;

            // Rate assorbimento (esponenziale, k in 1/min)
            // const assorbRate = stomacoPieno ? 0.02 : 0.05; // k per curva 1 - e^(-kt)

            // Calcola numero totale di ingestioni
            let totalIngestions = 0;
            addedDrinks.forEach(drink => {
                totalIngestions += drink.qty;
            });

            // Calcola intervallo tra ingestioni
            const intervallo = (totalIngestions > 1) ? durataMinuti / (totalIngestions - 1) : 0;

            // Crea lista di tempi di ingestione
            let tempiIngestioni = [];
            let currentTime = 0;
            addedDrinks.forEach(drink => {
                const grammiSingle = calcolaGrammiAlcol(cocktailDatabase[drink.index].ingredienti, 0.95);
                for (let q = 0; q < drink.qty; q++) {
                    tempiIngestioni.push({tempo: currentTime, grammi: grammiSingle});
                    currentTime += intervallo;
                }
            });

            // Funzione per calcolare BAC a un dato tempo
            function calculateBACAtTime(timeFromStart) {
                let bac = 0;
                tempiIngestioni.forEach(ing => {
                    const grammiEff = ing.grammi * (stomacoPieno ? 0.7 : 1.0);
                    const timeFromIng = timeFromStart - ing.tempo;
                    if (timeFromIng >= 0) {
                        // Assorbimento istantaneo (come versione originale funzionante)
                        const contrib = grammiEff / (peso * fattoreWidmark);
                        bac += Math.max(0, contrib - (betaPerMinuto * timeFromIng));
                    }
                });
                return bac;
            }

            // Debug info
            console.log("Fitness Level:", fitnessLevel);
            console.log("Esercizio Same Day:", esercizioSameDay);
            console.log("Esercizio Factor:", esercizioFactor);



            // Trova il picco reale simulando ogni 5min
            let maxBAC = 0;
            for (let min = 0; min <= minutiPrimo + 360; min += 5) {
                const bac = calculateBACAtTime(min);
                if (bac > maxBAC) maxBAC = bac;
            }

            // Alcolemia attuale
            let alcolemiaAttuale = calculateBACAtTime(minutiPrimo);

            const minutiAzzeramentoCurrent = alcolemiaAttuale / betaPerMinuto;
            const minutiPerGuidareCurrent = Math.max(0, (alcolemiaAttuale - 0.5) / betaPerMinuto);

            return {
                alcolemiaPicco: Math.round(maxBAC * 1000) / 1000,
                alcolemiaAttuale: Math.round(alcolemiaAttuale * 1000) / 1000,
                grammiEffettivi: Math.round(totalGrammiAlcol * (stomacoPieno ? 0.7 : 1.0) * 10) / 10,
                fattoreWidmark: Math.round(fattoreWidmark * 1000) / 1000,
                tbw: Math.round(calcolaTBW(genere, peso, altezza, eta, fitnessLevel, idratazione) * 10) / 10,
                oreAzzeramento: Math.round(minutiAzzeramentoCurrent / 60 * 10) / 10,
                orePerGuidare: Math.round(minutiPerGuidareCurrent / 60 * 10) / 10,
                betaPerOra: Math.round(betaPerOra * 1000) / 1000,
                statoLegale: getStatoLegale(alcolemiaAttuale),
                funzioneAlcolemia: (additionalMin) => {
                    const timeFut = minutiPrimo + additionalMin;
                    return Math.round(calculateBACAtTime(timeFut) * 1000) / 1000;
                }
            };
        }

        function getStatoLegale(alcolemia) {
            if (alcolemia <= 0.5) return {status: 'ok', text: 'Entro i limiti (guida consentita)'};
            else if (alcolemia <= 0.8) return {status: 'warning', text: 'OLTRE I LIMITI - Sanzione amministrativa'};
            else if (alcolemia <= 1.5) return {status: 'danger', text: 'OLTRE I LIMITI - Sanzione penale'};
            else return {status: 'danger', text: 'OLTRE I LIMITI - Sanzione penale grave'};
        }

        

        // Funzioni di interfaccia
        function showSection(sectionId, tab) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            tab.classList.add('active');
            
            if (sectionId === 'lista') {
                loadCocktailList();
            }
        }


        // Funzione di ricerca avanzata
        // Inizzializziamo i filtri attivi
        let activeFilters = ['nome']; // Array che mantiene di default il filtro "nome" attivo

        function highlightText(text, query) {
            if (!query) return text;
            // RegExp con flag 'gi': g=global (tutte le occorrenze), i=case insensitive
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<span class="ingredient-highlight">$1</span>');
        }

        function searchInIngredients(cocktail, query) {
            // some() restituisce true se ALMENO UN ingrediente contiene la query
            return cocktail.ingredienti.some(ingrediente => 
                ingrediente.nome.toLowerCase().includes(query.toLowerCase())
            );
        }

        function getMatchingIngredients(cocktail, query) {
            // filter() restituisce TUTTI gli ingredienti che matchano
            return cocktail.ingredienti.filter(ingrediente => 
                ingrediente.nome.toLowerCase().includes(query.toLowerCase())
            );
        }

        // Vera funzione di ricerca
        function searchCocktail() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            const results = document.getElementById('searchResults');
            const stats = document.getElementById('searchStats');
    
            if (query.length < 2) {
                results.innerHTML = '';
                stats.innerHTML = '';
                return;
            }

            let matches = [];

            // forEach vs for loop: forEach è più "funzionale", for è più "imperativo"
            cocktailDatabase.forEach(cocktail => {
                let found = false;
                let matchType = '';
                let matchDetails = '';

                // Cerca nel nome se il filtro è attivo
                if (activeFilters.includes('nome') && cocktail.nome.toLowerCase().includes(query)) {
                    found = true;
                    matchType = 'Nome';
                }

                // Cerca nella categoria se il filtro è attivo
                if (activeFilters.includes('categoria') && cocktail.categoria.toLowerCase().includes(query)) {
                    found = true;
                    // Operatore ternario: condizione ? valore_se_vero : valore_se_falso
                    matchType = matchType ? matchType + ', Categoria' : 'Categoria';
                }

                // Cerca negli ingredienti se il filtro è attivo
                if (activeFilters.includes('ingredienti') && searchInIngredients(cocktail, query)) {
                    found = true;
                    const matchingIngredients = getMatchingIngredients(cocktail, query);
                    matchType = matchType ? matchType + ', Ingredienti' : 'Ingredienti';
                    // map() trasforma ogni ingrediente nel suo nome, join() li unisce con virgole
                    matchDetails = matchingIngredients.map(ing => ing.nome).join(', ');
                }

                if (found) {
                    // push() aggiunge un elemento alla fine dell'array
                    matches.push({
                        cocktail: cocktail,
                        matchType: matchType,
                        matchDetails: matchDetails
                    });
                }
            });

            // Template literal (backticks) per interpolazione di stringhe
            stats.innerHTML = `Trovati ${matches.length} cocktail${matches.length !== 1 ? 's' : ''} per "${query}"`;

            if (matches.length === 0) {
                results.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Nessun cocktail trovato</p>';
                return;
            }

            // map() trasforma ogni match in HTML, join('') unisce tutto senza separatori
            results.innerHTML = matches.map(match => {
                const cocktail = match.cocktail;
                const gradazione = calcolaGradazione(cocktail.ingredienti);
                const alcolPuro = calcolaGrammiAlcol(cocktail.ingredienti);
        
                return `
                    <div class="results">
                        <h3 style="color: #333; margin-bottom: 10px;">
                            ${cocktail.nome}
                        </h3>
                        <div style="font-size: 12px; color: #667eea; margin-bottom: 10px;">
                            <i class="fas fa-search"></i> Trovato in: ${match.matchType}
                            ${match.matchDetails ? ` (${match.matchDetails})` : ''}
                        </div>
                        <div class="result-item">
                            <span class="result-label">Categoria:</span>
                            <span class="result-value">
                                ${cocktail.categoria}
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Gradazione:</span>
                            <span class="result-value">${gradazione.toFixed(1)}% vol</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Alcol puro:</span>
                            <span class="result-value">${alcolPuro.toFixed(1)} g</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Bicchiere:</span>
                            <span class="result-value">${cocktail.bicchiere} ml</span>
                        </div>
                        <div style="margin-top: 10px;">
                            <strong>Ingredienti:</strong><br>
                            ${cocktail.ingredienti.map(ing => {
                                // Evidenzia se il filtro ingredienti è attivo E questo ingrediente contiene la query, anche se sono attivi altri filtri
                                const shouldHighlight = activeFilters.includes('ingredienti') &&
                                                        ing.nome.toLowerCase().includes(query.toLowerCase());
                                const highlighted = shouldHighlight ? highlightText(ing.nome, query) : ing.nome;
                                return `• ${highlighted}: ${ing.volume} ml${ing.gradazione > 0 ? ` (${ing.gradazione}% vol)` : ' (analcolico)'}`;
                            }).join('<br>')}
                        </div>
                        <div style="margin-top: 10px; font-size: 15px; color: #555;">
                            <em>${cocktail.note}</em>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Stampa risultato finale
        function updateCocktailInfo() {
            const input = document.getElementById('cocktailName');
            const info = document.getElementById('cocktailInfo');
            const name = input.value.trim().toLowerCase();
            
            const cocktail = cocktailDatabase.find(c => c.nome.toLowerCase() === name);
            
            if (!cocktail) {
                info.style.display = 'none';
                return;
            }

            const gradazione = calcolaGradazione(cocktail.ingredienti);
            const alcolPuro = calcolaGrammiAlcol(cocktail.ingredienti);

            document.getElementById('gradazione').textContent = `${gradazione.toFixed(1)}% vol`;
            document.getElementById('alcolPuro').textContent = `${alcolPuro.toFixed(1)} g`;
            
            info.style.display = 'block';
        }

        function aggiungiDrink() {
            const nameInput = document.getElementById('cocktailName');
            const quantitaInput = document.getElementById('quantita');
            const name = nameInput.value.trim().toLowerCase();
            const cocktail = cocktailDatabase.find(c => c.nome.toLowerCase() === name);
            if (!cocktail) {
                alert('Cocktail non trovato!');
                return;
            }
            const qty = parseInt(quantitaInput.value) || 1;
            if (qty <= 0) {
                alert('Quantità deve essere almeno 1!');
                return;
            }
            const index = cocktailDatabase.indexOf(cocktail);
            addedDrinks.push({index, qty});
            updateAddedDrinks();
            quantitaInput.value = '1';
            nameInput.value = '';
            document.getElementById('cocktailInfo').style.display = 'none';
        }

        function removeDrink(i) {
            addedDrinks.splice(i, 1);
            updateAddedDrinks();
        }

        function updateAddedDrinks() {
            const list = document.getElementById('addedDrinks');
            list.innerHTML = '';
            let total = 0;
            addedDrinks.forEach((drink, i) => {
                const cocktail = cocktailDatabase[drink.index];
                const alcol = calcolaGrammiAlcol(cocktail.ingredienti) * drink.qty;
                total += alcol;
                const div = document.createElement('div');
                div.className = 'added-drink';
                div.innerHTML = `
                    ${cocktail.nome} x ${drink.qty} - Alcol: ${alcol.toFixed(1)}g
                    <button onclick="removeDrink(${i})">X</button>
                `;
                list.appendChild(div);
            });
            document.getElementById('totalAlcol').textContent = total.toFixed(1);
        }

        function calcolaAlcolemia() {
            if (addedDrinks.length === 0) {
                document.getElementById('alcolemiaResults').innerHTML = '<div class="warning">Aggiungi almeno un drink!</div>';
                return;
            }
            const genere = document.getElementById('genere').value;
            const peso = parseFloat(document.getElementById('peso').value);
            const altezza = parseFloat(document.getElementById('altezza').value);
            const eta = parseInt(document.getElementById('eta').value);
            const stomacoPieno = document.getElementById('stomaco').value === 'true';
            const durataMinuti = parseInt(document.getElementById('durataMinuti').value) || 0;
            const minutiPrimo = parseInt(document.getElementById('minutiPrimo').value) || 0;
            // Leggi il checkbox solo se è visibile (attivo/atleta)
            const fitnessLevel = document.getElementById('fitnessLevel').value;
            const esercizioSameDay = (fitnessLevel === 'attivo' || fitnessLevel === 'atleta') ? 
                document.getElementById('esercizioSameDay').value === 'si' : false;
            const idratazione = document.getElementById('idratazione').value;
            const resultsDiv = document.getElementById('alcolemiaResults');

            if (!peso || !altezza || !eta) {
                resultsDiv.innerHTML = '<div class="warning">Compila tutti i campi!</div>';
                return;
            }

            let warningHTML = '';
            if (eta < 18 || peso > 150) {
                warningHTML = '<div class="warning" style="font-size: 13px; line-height: 1.4; margin-top: 20px;">';
                if (eta < 18) {
                    warningHTML += 'Attenzione: Per età inferiore a 18, <br> BAC reale potrebbe essere più alto <br> (sottostima TBW ~10/20%). <br>';
                }
                if (peso > 150) {
                    warningHTML += 'Attenzione: Per peso maggiore a 150kg, <br> BAC reale potrebbe essere più alto <br> (sovrastima TBW ~10/20%).';
                }
                warningHTML += '</div>';
            }

            if (durataMinuti > minutiPrimo) {
                resultsDiv.innerHTML = '<div class="warning">Durata non può essere maggiore dei minuti dal primo drink</div>';
                return;
            }

            let totalGrammiAlcol = 0;
            addedDrinks.forEach(drink => {
                const cocktail = cocktailDatabase[drink.index];
                totalGrammiAlcol += calcolaGrammiAlcol(cocktail.ingredienti) * drink.qty;
            });
            
            if (totalGrammiAlcol === 0) {
                resultsDiv.innerHTML = '<div class="warning">Nessun alcol nei drink selezionati!</div>';
                return;
            }

            // Chiamata finale
            const risultato = calcolaAlcolemiaMultipla(totalGrammiAlcol, genere, peso, altezza, eta, stomacoPieno, durataMinuti, minutiPrimo, fitnessLevel, esercizioSameDay, idratazione);
            
            let timelineHTML = '<h4>Timeline Alcolemia</h4>';
            for (let h = 1; h <= 6; h++) {
                const futAlc = risultato.funzioneAlcolemia(h * 60);
                if (futAlc <= 0) break;
                timelineHTML += `<div class="result-item">
                    <span class="result-label">Tra ${h} ore:</span>
                    <span class="result-value">${futAlc.toFixed(3)} g/L</span>
                </div>`;
            }

            // Descrizione del livello fitness
            const fitnessDescription = {
                'atleta': 'Atleta (+20% metabolismo)',
                'attivo': 'Attivo (+10% metabolismo)', 
                'sedentario': 'Sedentario (metabolismo base)'
            };

            resultsDiv.innerHTML = `
                <div class="results">
                    <h3 style="color: #333; margin-bottom: 15px;">Risultati Alcolemia</h3>
                    <div class="result-item">
                        <span class="result-label">Livello fitness:</span>
                        <span class="result-value" style="font-size: 13px;">
                            ${fitnessDescription[fitnessLevel]}
                        </span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Alcolemia al picco (fine bevute):</span>
                        <span class="result-value">${risultato.alcolemiaPicco} g/L</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Alcolemia attuale:</span>
                        <span class="result-value">${risultato.alcolemiaAttuale} g/L</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">TBW:</span>
                        <span class="result-value">${risultato.tbw} litri</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Fattore Widmark:</span>
                        <span class="result-value">${risultato.fattoreWidmark}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Tasso eliminazione:</span>
                        <span class="result-value">${risultato.betaPerOra} g/L/h</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Tempo per azzeramento:</span>
                        <span class="result-value">${formatTime(risultato.oreAzzeramento)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Tempo per guidare:</span>
                        <span class="result-value">${formatTime(risultato.orePerGuidare)}</span>
                    </div>
                    <div class="legal-status legal-${risultato.statoLegale.status}">
                        ${risultato.statoLegale.text}
                    </div>
                    ${timelineHTML}
                </div>
                ${warningHTML}
                <div class="warning" style="font-size: 13px; line-height: 1.4;">
                    ATTENZIONE: Questo è un calcolo teorico. <br> L'alcolemia reale può variare per fattori individuali. <br> Non guidare mai dopo aver bevuto alcol.
                </div>
            `;
        }

        function loadCocktailList() {
            const list = document.getElementById('cocktailList');
            list.innerHTML = cocktailDatabase.map(cocktail => {
                const gradazione = calcolaGradazione(cocktail.ingredienti);
                const alcolPuro = calcolaGrammiAlcol(cocktail.ingredienti);
                
                return `
                    <div class="cocktail-item">
                        <div class="cocktail-name">${cocktail.nome}</div>
                        <div class="cocktail-info">
                            ${gradazione.toFixed(1)}% vol • ${alcolPuro.toFixed(1)}g alcol • ${cocktail.categoria}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterCocktails() {
            const filter = document.getElementById('filterInput').value.toLowerCase();
            const items = document.querySelectorAll('.cocktail-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(filter) ? 'block' : 'none';
            });
        }

        // Inizializzazione
        document.addEventListener('DOMContentLoaded', function() {
            loadCocktailList();
            
            // Event listeners
            document.getElementById('searchInput').addEventListener('input', searchCocktail);
            document.getElementById('filterInput').addEventListener('input', filterCocktails);
            document.getElementById('cocktailName').addEventListener('input', updateCocktailInfo);
            document.getElementById('aggiungiDrinkBtn').addEventListener('click', aggiungiDrink);
            document.getElementById('calcolaBtn').addEventListener('click', calcolaAlcolemia);
            document.getElementById('fitnessLevel').addEventListener('change', function() {
                const group = document.getElementById('esercizioSameDayGroup');
                const level = this.value;
                group.style.display = (level === 'attivo' || level === 'atleta') ? 'block' : 'none';
            });

            // Gestione filtri di ricerca
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    // getAttribute legge il valore dell'attributo HTML
                    const filter = this.getAttribute('data-filter');
        
                    if (this.classList.contains('active')) {
                        // Se è l'ultimo filtro attivo, non permettere di rimuoverlo
                        if (activeFilters.length === 1) return;
            
                        // classList.remove() rimuove una classe CSS
                        this.classList.remove('active');
                        // filter() crea un nuovo array escludendo gli elementi che matchano la condizione
                        activeFilters = activeFilters.filter(f => f !== filter);
                    } else {
                        // classList.add() aggiunge una classe CSS
                        this.classList.add('active');
                        // push() aggiunge un elemento alla fine dell'array
                        activeFilters.push(filter);
                    }

                    // Aggiorna la ricerca solo se c'è testo sufficiente
                    if (document.getElementById('searchInput').value.length >= 2) {
                        searchCocktail();
                    }
                });
            });
            
            // Tab navigation
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section');
                    showSection(sectionId, this);
                });
            });
        });
    </script>
</body>
</html>